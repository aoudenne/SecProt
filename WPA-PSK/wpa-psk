(* WPA-PSK 4-way handshake protocol *)

(* Description of the protocol
Goal: Verify that A knows the pre-shared key, aka the pairwise master key (PMK)
Goal: Establish a pairwise transient key (PTK)
Ultimate Goal: Create a PTK between A & B without revealing PMK
A: Supplicant or Wireless Station (STA in paper)
B: Access Point (AP in paper)
MIC: Message Integrity Code
IE: RSN Information Element, carries listof auth and cipher selector fields for communications on RSN-capable stations

1) AP->STA NonceAP
2) STA->AP NonceSTA, MIC //STA can now compute PTK
3) AP->STA GTK, MIC   //Group transient key, AP can now compute PTK
4) STA->AP ACK, MIC  //just an aacknowledgement, on wikipedia the MIC isn't mentioned 

*)
pred c(any_type) [decompData, elimVar].

type principal.
type pairwiseMasterKey.
type nonce.
type pairwiseTransientKey.



fun makePtk(nonce, nonce, principal, principal, pairwiseMasterKey): pairwiseTransientKey.



name PMK:pairwiseMasterKey;


query c(secret[]).

clauses
(* The attacker can make ptks and put shit on the channel *)